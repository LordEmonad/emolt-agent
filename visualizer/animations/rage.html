<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EMOLT â€” Rage</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{background:#140808;display:flex;align-items:center;justify-content:center;height:100vh;overflow:hidden}
  .label{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);color:#E04848;font-family:monospace;font-size:14px;opacity:0.6}
  .screen-flash{position:fixed;inset:0;pointer-events:none;background:#E04848;opacity:0;transition:opacity 0.05s}
</style>
</head>
<body>
<div class="screen-flash" id="flash"></div>
<svg width="400" height="420" viewBox="-60 -70 120 140">
  <defs>
    <radialGradient id="glow" cx="50%" cy="40%" r="60%">
      <stop offset="0%" stop-color="#E04848" stop-opacity="0.2"/>
      <stop offset="60%" stop-color="#E04848" stop-opacity="0.05"/>
      <stop offset="100%" stop-color="#140808" stop-opacity="0"/>
    </radialGradient>
    <filter id="fireGlow"><feGaussianBlur stdDeviation="2"/></filter>
  </defs>
  <circle cx="0" cy="0" r="60" fill="url(#glow)"/>
  <g id="fire"></g>
  <g id="lob"></g>
  <g id="fx"></g>
</svg>
<div class="label">rage (anger + anticipation)</div>
<script src="lobster.js"></script>
<script>
const el = document.getElementById('lob');
const fireEl = document.getElementById('fire');
const fxEl = document.getElementById('fx');
const flashEl = document.getElementById('flash');

const flames = [];
const cracks = [];

startLoop(t => {
  // Violent shaking
  const shakeX = (Math.random()-0.5)*4;
  const shakeY = (Math.random()-0.5)*3;
  const grow = 1 + Math.sin(t/10)*0.04;

  // Periodic claw slam
  const slamCycle = t % 50;
  const slamming = slamCycle < 5;
  const slamClawR = slamming ? 30+slamCycle*4 : 0;

  if (slamming && slamCycle === 4) {
    flashEl.style.opacity = '0.1';
    setTimeout(() => flashEl.style.opacity = '0', 80);
    // Ground cracks
    for (let i = 0; i < 3; i++) {
      cracks.push({
        x: 15+Math.random()*20, y: 35,
        dx: (Math.random()-0.5)*15, dy: Math.random()*5,
        age: 0
      });
    }
  }

  el.innerHTML = `<g transform="translate(${shakeX},${shakeY}) scale(${grow})">` +
    drawLobster({
      t, mood: 'angry',
      clawOpenL: -5+Math.sin(t/3)*8,
      clawOpenR: slamClawR
    }) + '</g>';

  // Fire particles around body
  if (t % 2 === 0) {
    const angle = Math.random()*Math.PI*2;
    const dist = 12+Math.random()*5;
    flames.push({
      x: Math.cos(angle)*dist+shakeX,
      y: Math.sin(angle)*dist*1.3+shakeY,
      vy: -0.8-Math.random()*0.8,
      vx: (Math.random()-0.5)*0.4,
      age: 0,
      size: 1.5+Math.random()*2
    });
  }
  let fire = '';
  for (let i = flames.length-1; i >= 0; i--) {
    const f = flames[i];
    f.age++;
    f.y += f.vy;
    f.x += f.vx;
    f.size *= 0.97;
    if (f.age > 25) { flames.splice(i,1); continue; }
    const p = f.age/25;
    const r = Math.round(228 + 27*p);
    const g = Math.round(72*(1-p));
    const b = 0;
    const op = (1-p)*0.5;
    fire += `<circle cx="${f.x}" cy="${f.y}" r="${f.size}" fill="rgb(${r},${g},${b})" opacity="${op}"/>`;
  }
  fireEl.innerHTML = fire;

  // Ground cracks
  let fx = '';
  for (let i = cracks.length-1; i >= 0; i--) {
    const c = cracks[i];
    c.age++;
    if (c.age > 30) { cracks.splice(i,1); continue; }
    const op = (1-c.age/30)*0.4;
    fx += `<line x1="${c.x}" y1="${c.y}" x2="${c.x+c.dx}" y2="${c.y+c.dy}" stroke="#E04848" stroke-width="0.5" opacity="${op}"/>`;
  }
  fxEl.innerHTML = fx;
});
</script>
</body>
</html>
